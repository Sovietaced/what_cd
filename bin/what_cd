#!/usr/bin/env ruby

begin
  require 'rubygems'
rescue LoadError
  # no rubygems to load, so we fail silently
end

require 'optparse'
require 'what_cd'

OPTIONS = {}
MANDATORY_OPTIONS = %w[]

parser = OptionParser.new do |opts|
  opts.banner = <<BANNER
Usage: #{File.basename($0)} [directory]

Options are:
BANNER
  opts.separator ''
  opts.on('-v', '--version',
          "Show the #{File.basename($0)} version number and exit") { require 'what-cd/version'; puts "what-cd #{WhatCD::VERSION}"; exit }
  opts.on('-t', '--tracker',
          "Create torrent file with tracker") { |tracker|  OPTIONS[:tracker] = tracker }
  opts.on('-e', '--encoding', String,
          "Set lame encoding options", "Default: #{WhatCD.default_encoding}") { |encoding|  OPTIONS[:encoding] = encoding }
  opts.on('-h', '--help',
          'Show this help message.') { puts opts; exit }  
  opts.parse!(ARGV)

  if MANDATORY_OPTIONS && MANDATORY_OPTIONS.find { |option| OPTIONS[option.to_sym].nil? }
    puts opts; exit
  end

  # do stuff
  dir = ARGV[0]

  #WhatCD.convert(dir, OPTIONS)
end