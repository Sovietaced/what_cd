#!/usr/bin/env ruby

require 'rubygems'
require 'commander/import'
require 'logging'
require 'pathname'

require '../lib/what_cd/version'
require '../lib/what_cd/sanitize'

# :name is optional, otherwise uses the basename of this executable
program :name, 'WHAT.CD'
program :version, WhatCD::VERSION
program :description, 'WHAT.CD tools'

global_option('--verbose') { $verbose = true }

command :sanitize do |c|
  c.syntax = 'what_cd sanitize [dir]'
  c.description = 'Displays foo'
  c.action do |args, options|
    raise ArgumentError.new("dir argument required") unless args.count > 0
    path = sanitize_path(args[0])
    Sanitize.run(path)
  end
end

def sanitize_path(path)
  # Force add a trailing '/'
  #path = path.chomp('/')
  #path << '/'

  if (Pathname.new(path).absolute?)
    return path
  else 
    return Dir.pwd + '/' + path
  end
end